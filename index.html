<!DOCTYPE html>
<html ng-app='myApp'>
<head>
    <link rel="stylesheet" type="text/css" href="1.css"></link>
	<title>First Page</title>
	<script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
<script
  src="https://code.jquery.com/jquery-3.3.1.js"
  integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60="
  crossorigin="anonymous"></script>
  <script type="text/javascript" src="angular.min.js"></script>
  <script type="text/javascript" src="main.js"></script>
</head>
<body ng-controller='MyController'>
<div>
	<img src="0.png">
	<br>
	<h1><span class="n">Process Management by CPM</span></h1>
</div>
<br>
<div><hr></div>
<div style="margin-left:37%">
    <input type="file" id="fileupload" hidden="hidden" accept=".xlsx,.xls" />
	<BUTTON class="b" id="b1">Choose File</BUTTON>
	<span id="text1" style="color:black">No file selected</span>
    <BUTTON class="b" id="b2" style="margin-left:10%" ng-click="uploadExcel()">Submit</BUTTON>
</div>
<br>
<span id="text2" class="m"></span>
<div style="margin-left:30%">
<h4>Please select an Excel File which contains data of the various processes</h4>
</div>
<div>
	<table id="myTable">
		<thead>
			<tr>
				<th>ID</th>
				<th>pre</th>
				<th>O</th>
			</tr>
		</thead>
		<tbody>
			
		</tbody>

	</table>
</div>


<script type="text/javascript">
	var flag=0;
const file1 = document.getElementById("fileupload");
const	but1 = document.getElementById("b1");
const   but2= document.getElementById("b2");
const text1 = document.getElementById("text1");
const text2 = document.getElementById("text2");
const t1 = document.getElementById("t1");
but1.addEventListener("click",function()
{
file1.click();
}) ;
file1.addEventListener	("change",function()
{
if(file1.value)
{
	text1.innerHTML = file1.value.match( /[\/\\]([\w\d\s\.\-\(\)]+)$/)[1];
	flag=1;
}
});
but2.addEventListener ("click",function()
	{   if(flag==0)
			text2.innerHTML = "Please choose a file!";
	});
</script>
</body>
</html>